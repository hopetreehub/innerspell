# 📋 PM 작업지시서: Vercel 이미지 404 문제 근본 해결

## 🎯 목표
Vercel 배포 환경에서 모든 이미지가 정상적으로 표시되도록 근본 원인을 파악하고 해결

## 📊 현재 상황 분석
### 문제 진화 과정
1. **1단계**: Next.js Image Optimization API 400 에러
2. **2단계**: unoptimized 속성 추가 후 404 에러 발생
3. **결론**: public 폴더 자체가 Vercel에 배포되지 않음

### 핵심 문제
- 로컬: `/public/logo.png`, `/public/images/*.png` 정상 존재
- Vercel: 모든 정적 파일 404 반환
- 원인: Vercel 빌드 프로세스에서 public 폴더 누락

## 🔍 작업 계획

### Phase 1: 진단 및 검증 (30분)
1. **Vercel 빌드 출력 분석**
   - `.vercel/output` 디렉토리 구조 확인
   - static 폴더 내 파일 존재 여부 검증
   - 빌드 로그에서 "Collecting static files" 단계 확인

2. **설정 파일 검토**
   - `.vercelignore` 파일 존재 및 내용 확인
   - `vercel.json` 설정 재검토
   - `next.config.ts`의 정적 파일 관련 설정 확인

3. **배포 파일 검증**
   - Vercel 대시보드에서 Functions 탭 확인
   - Output 파일 시스템 구조 확인

### Phase 2: 해결 방안 구현 (45분)

#### 방안 A: Vercel 설정 수정
```json
{
  "functions": {
    "src/app/**/*.{js,ts,tsx}": {
      "includeFiles": "public/**"
    }
  },
  "rewrites": [
    {
      "source": "/images/:path*",
      "destination": "/public/images/:path*"
    }
  ]
}
```

#### 방안 B: Next.js 정적 import 전환
1. 모든 이미지를 `src/assets/images`로 이동
2. 정적 import 사용:
   ```tsx
   import heroImage from '@/assets/images/tarothome.png'
   import aiImage from '@/assets/images/1ai.png'
   ```
3. Image 컴포넌트에서 import된 이미지 사용

#### 방안 C: Public 폴더 강제 포함
1. `next.config.ts`에 추가:
   ```typescript
   experimental: {
     outputFileTracingIncludes: {
       '/': ['./public/**/*']
     }
   }
   ```

### Phase 3: 단계별 테스트 (30분)
1. **로컬 빌드 테스트**
   ```bash
   npm run build
   # .next/standalone 확인
   # .next/static 확인
   ```

2. **Vercel CLI 로컬 테스트**
   ```bash
   vercel build
   vercel dev
   ```

3. **Playwright 검증 스크립트**
   - 각 해결 방안별 테스트 스크립트 작성
   - 이미지 로딩 성공률 측정

### Phase 4: 최적 솔루션 선택 및 적용 (20분)
1. 각 방안의 장단점 비교
2. 가장 안정적인 솔루션 선택
3. 전체 프로젝트에 일괄 적용

### Phase 5: 최종 검증 (15분)
1. Vercel 프로덕션 배포
2. Chromium으로 전체 페이지 스크린샷 및 검증
3. 성능 메트릭 확인 (LCP, CLS)

## 📈 성공 지표
- [ ] 홈페이지 6개 이미지 모두 표시
- [ ] 블로그 썸네일 이미지 모두 표시
- [ ] 로고 이미지 정상 표시
- [ ] 404 에러 0개
- [ ] 페이지 로드 시간 3초 이내

## ⚠️ 리스크 관리
1. **빌드 시간 증가**: 이미지 import 방식은 빌드 시간 증가 가능
2. **번들 크기**: 정적 import는 JS 번들 크기 증가
3. **캐싱 전략**: CDN 캐싱 설정 재검토 필요

## 🔧 필요 도구
- Vercel CLI
- Playwright
- Chrome DevTools
- 빌드 분석 도구

## 📅 예상 소요 시간
총 2시간 30분 (버퍼 30분 포함)

## 🚀 실행 승인 대기
이 작업지시서에 따라 체계적으로 문제를 해결하겠습니다. 
승인 후 Phase 1부터 순차적으로 진행하겠습니다.